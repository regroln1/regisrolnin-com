---
import type { CollectionEntry } from 'astro:content';

interface Props {
  currentSlug: string;
  allPosts: CollectionEntry<'blog'>[];
}

const { currentSlug, allPosts } = Astro.props;

// Trier les posts par date (du plus récent au plus ancien)
const sortedPosts = allPosts
  .filter(post => !post.data.draft)
  .sort((a, b) => new Date(b.data.pubDate).getTime() - new Date(a.data.pubDate).getTime());

// Trouver l'index du post actuel
const currentIndex = sortedPosts.findIndex(post => post.slug === currentSlug);

// Posts précédent et suivant
const previousPost = currentIndex < sortedPosts.length - 1 ? sortedPosts[currentIndex + 1] : null;
const nextPost = currentIndex > 0 ? sortedPosts[currentIndex - 1] : null;
---

{(previousPost || nextPost) && (
  <section class="py-12 bg-gradient-to-br from-gray-50 to-blue-50">
    <div class="container mx-auto px-6">
      <div class="max-w-6xl mx-auto">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          
          <!-- Article Précédent -->
          {previousPost ? (
            <a 
              href={`/blog/${previousPost.slug}`}
              class="group bg-white rounded-2xl shadow-lg border border-gray-100 p-8 hover:shadow-2xl hover:-translate-y-1 transition-all duration-300"
            >
              <div class="flex items-center mb-4 text-gray-500 group-hover:text-blue-600 transition-colors">
                <svg class="w-5 h-5 mr-2 transform group-hover:-translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
                <span class="text-sm font-semibold uppercase tracking-wider">Article Précédent</span>
              </div>
              
              <h3 class="text-xl font-bold text-navy-900 font-crimson mb-3 line-clamp-2 group-hover:text-blue-600 transition-colors">
                {previousPost.data.title}
              </h3>
              
              <p class="text-gray-600 font-crimson line-clamp-2 mb-4">
                {previousPost.data.description}
              </p>
              
              {previousPost.data.tags && previousPost.data.tags[0] && (
                <span class="inline-block px-3 py-1 text-xs font-semibold bg-blue-100 text-blue-700 rounded-full">
                  {previousPost.data.tags[0]}
                </span>
              )}
            </a>
          ) : (
            <div class="bg-gray-100 rounded-2xl p-8 flex items-center justify-center opacity-50">
              <p class="text-gray-500 font-crimson">Aucun article précédent</p>
            </div>
          )}

          <!-- Article Suivant -->
          {nextPost ? (
            <a 
              href={`/blog/${nextPost.slug}`}
              class="group bg-white rounded-2xl shadow-lg border border-gray-100 p-8 hover:shadow-2xl hover:-translate-y-1 transition-all duration-300"
            >
              <div class="flex items-center justify-end mb-4 text-gray-500 group-hover:text-blue-600 transition-colors">
                <span class="text-sm font-semibold uppercase tracking-wider">Article Suivant</span>
                <svg class="w-5 h-5 ml-2 transform group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
              </div>
              
              <h3 class="text-xl font-bold text-navy-900 font-crimson mb-3 line-clamp-2 group-hover:text-blue-600 transition-colors text-right">
                {nextPost.data.title}
              </h3>
              
              <p class="text-gray-600 font-crimson line-clamp-2 mb-4 text-right">
                {nextPost.data.description}
              </p>
              
              {nextPost.data.tags && nextPost.data.tags[0] && (
                <div class="text-right">
                  <span class="inline-block px-3 py-1 text-xs font-semibold bg-purple-100 text-purple-700 rounded-full">
                    {nextPost.data.tags[0]}
                  </span>
                </div>
              )}
            </a>
          ) : (
            <div class="bg-gray-100 rounded-2xl p-8 flex items-center justify-center opacity-50">
              <p class="text-gray-500 font-crimson">Aucun article suivant</p>
            </div>
          )}
        </div>
      </div>
    </div>
  </section>
)}